---
title: "OrioleDB - 云原生存储引擎"
date: 2023-11-14 10:09:56
categories: 数据库
tags:
  - OrioleDB
  - PostgreSQL
---

OrioleDB 是为 PostgreSQL 开发的新的存储引擎，它是基于 PostgreSQL 的表访问（Table Access Method）框架和其他 PostgreSQL 标准的扩展接口开发的一个插件。通过扩展和增强当前的表访问方法，OrioleDB 为未来更强大的存储模型打开了大门，这些模型针对云和现代硬件架构进行了优化。

1. 专为现代硬件而设计。OrioleDB 设计避免了包含数十个和数百个 CPU 核心的现代服务器上的遗留 CPU 瓶颈，从而优化了现代存储技术（例如 SSD 和 NVRAM）的使用。
2. 减少维护需求。OrioleDB 实现了 undo 日志和页面合并的概念，消除了对专用垃圾收集过程的需要。此外，OrioleDB 实现了默认的 64 位事务标识符，从而消除了众所周知且令人痛苦的环绕问题。
3. 为分布式设计。OrioleDB 实现了行级预写日志并支持并行应用。该日志架构针对基于 raft 共识的复制进行了优化，允许实现双主。

OrioleDB 包含以下关键技术：

1. 没有缓冲区映射和无锁页面读取。OrioleDB 中的内存页面通过直接链接连接到存储页面。这消除了缓冲区内映射及其相关瓶颈的需要。此外，在 OrioleDB 中，内存页面读取不涉及原子操作。这些设计决策共同将 PostgreSQL 的垂直可扩展性提升到了一个全新的水平。
2. MVCC 基于 undo 日志概念。在 OrioleDB 中，旧版本的元组不会导致主存储系统膨胀，而是被逐出到包含撤消链的撤消日志中。页级撤消记录使系统能够轻松地尽快回收已删除元组占用的空间。这些机制与页面合并一起消除了大多数情况下的膨胀。也不需要对表进行专门的 VACUUM，从而消除了系统性能恶化和数据库中断的重要且常见的原因。
3. 写时复制检查点和行级 WAL。OrioleDB 利用写时复制检查点，它每时每刻都提供结构一致的数据快照。这对于现代 SSD 很友好，并允许行级 WAL 日志记录。反过来，行级 WAL 日志记录很容易并行化（已完成）、紧凑且适合多主（计划中）。

<div class="just-for-fun">
笑林广记 -
</div>
